ðŸ§­ ä¸€ã€ç³»ç»Ÿçš„æ ¸å¿ƒç›®æ ‡
ä½ çš„è´­ç‰©è½¦æŽ¨èç³»ç»Ÿè¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼š libgomp.so.1 
â€œä¸åŒç”¨æˆ·åœ¨ä¸åŒè´­ç‰©æƒ…å¢ƒä¸‹ï¼Œä»·æ ¼ä¸Žè´¨é‡ä¼˜å…ˆçº§æ˜¯åŠ¨æ€å˜åŒ–çš„â€”â€”
 ç³»ç»Ÿè¦èƒ½è‡ªåŠ¨è¯†åˆ«è¿™ç§å˜åŒ–ï¼Œè€Œä¸æ˜¯åªçœ‹åŽ†å²è´­ä¹°æ•°æ®ã€‚â€
æ‰€ä»¥æ•´ä¸ªæž¶æž„èžåˆäº†ï¼š
é¢„ç®—æ•æ„Ÿåº¦ï¼ˆé•¿æœŸè¡Œä¸ºç”»åƒï¼‰


å³æ—¶æ„å›¾ï¼ˆçŸ­æœŸä¼šè¯è¡Œä¸ºï¼‰


è½»é‡è§„åˆ™ï¼ˆGuardrailsï¼‰


æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼ˆLightGBM æŽ’åºå™¨ï¼‰



ðŸ§± äºŒã€ç³»ç»Ÿæ€»ä½“ç»“æž„
å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå››å±‚ç»“æž„ï¼š
ç”¨æˆ·è¡Œä¸º â†’ Guardrail è¿‡æ»¤ â†’ LightGBM æŽ’åº â†’ æŽ¨èè¾“å‡º

å±‚çº§
åŠŸèƒ½
ç¤ºä¾‹
1ï¸âƒ£ æ•°æ®ä¸Žç‰¹å¾å±‚
æ”¶é›†å¹¶ç”Ÿæˆç‰¹å¾ï¼šCFå¾—åˆ†ã€è¯­ä¹‰ç›¸ä¼¼åº¦ã€ä»·æ ¼å·®ã€Î²áµ¤ã€æ„å›¾åˆ†æ•°ç­‰
â€œè¿™ä¸ªäººä¹°æ¾éœ²ä¸”é¢„ç®—ç´§å¼ â€
2ï¸âƒ£ Guardrail å±‚
è½»è¿‡æ»¤ï¼Œä¸å‚ä¸Žæ‰“åˆ†ï¼›å®šä¹‰â€œå“ªäº›å€™é€‰å•†å“èƒ½è¿›æ¨¡åž‹â€
â€œå¿…é¡»åŒç”¨é€”ï¼Œä»·æ ¼ä¸è¶…åŽŸä»· 15%â€
3ï¸âƒ£ LightGBM å±‚
è¡Œä¸ºå­¦ä¹  + æ™ºèƒ½æŽ’åºï¼Œå†³å®šâ€œå“ªäº›å€™é€‰æŽ’å‰é¢â€
å­¦ä¼šåœ¨â€œä¿è´¨â€å’Œâ€œçœé’±â€é—´åŠ¨æ€æƒè¡¡
4ï¸âƒ£ è¾“å‡ºå±‚
ç”ŸæˆæŽ¨èåˆ—è¡¨ã€è®°å½•æ—¥å¿—ã€åé¦ˆå›žå­¦ä¹ ç³»ç»Ÿ
è¾“å‡ºä¸ªæ€§åŒ–ä¸”å¯è§£é‡Šçš„æŽ¨èç»“æžœ


ðŸ§© ä¸‰ã€æ ¸å¿ƒé€»è¾‘ç»†åŒ–
1. é•¿æœŸä»·æ ¼ç”»åƒ Î²áµ¤
åŸºäºŽåŽ†å²è´­ä¹°æ•°æ®ï¼š
è®¡ç®—ç”¨æˆ·åœ¨å„ç±»å•†å“çš„å¹³å‡å•ä»·ä¸Žåˆ†ä½ï¼›


ä¸Žå“ç±»å¹³å‡ä»·æ¯”å¯¹ï¼Œæ ‡å‡†åŒ–ä¸º z-scoreï¼›


é€šè¿‡ GBM/logistic å¾—åˆ°ä»·æ ¼æ•æ„Ÿåº¦ Î²áµ¤ âˆˆ [0,1]ï¼›


Î²áµ¤ é«˜ â†’ é«˜æ¶ˆè´¹ç”¨æˆ·ï¼›


Î²áµ¤ ä½Ž â†’ ä»·æ ¼æ•æ„Ÿã€‚ libgomp.so.1 


ä½œç”¨ï¼šè®©æ¨¡åž‹çŸ¥é“â€œè¿™ä¸ªäººå¹³æ—¶æ„¿ä¸æ„¿æ„ä¸ºå“è´¨å¤šèŠ±é’±â€ã€‚

2. å³æ—¶æ„å›¾ intent_keep_quality
åˆ†æžå½“å‰ä¼šè¯è¡Œä¸ºï¼š
å¦‚æžœå¤šæ¬¡åˆ é™¤é«˜ä»·æ¢ä½Žä»· â†’ â€œçœé’±æ„å›¾â€ï¼›


å¦‚æžœå¤šæ¬¡è¶…é¢„ç®—ä½†ä»è´­ä¹° â†’ â€œä¿è´¨æ„å›¾â€ï¼›


é€šè¿‡ sigmoid è®¡ç®—å‡ºå³æ—¶æ„å›¾åˆ†æ•°ï¼š


intent_keep_quality = sigmoid(a1*premium_anchor - a2*overshoot_ratio + a3*high_quality_keep_rate)

å†ç”¨ EMA å¹³æ»‘ï¼š
intent_keep_quality_ema = 0.3 * now + 0.7 * prev

é˜²æ­¢çŸ­æ—¶é—´å‰§çƒˆæ³¢åŠ¨ã€‚
å¹¶åŠ ä¸Š å†·å´æ—¶é—´ï¼ˆâ‰¥45sï¼‰ï¼š
é˜²æ­¢æ¨¡å¼é¢‘ç¹åˆ‡æ¢é€ æˆæŽ¨èæŠ–åŠ¨ã€‚

3. Guardrailï¼ˆè½»é‡å®‰å…¨è¾¹ç•Œï¼‰
å®šä¹‰ä¸åŒæ„å›¾ä¸‹å…è®¸è¿›å…¥æ¨¡åž‹çš„å€™é€‰å•†å“èŒƒå›´ï¼š
æ¨¡å¼
è¿‡æ»¤é€»è¾‘
ç¤ºä¾‹
ä½œç”¨
Economy
åŒç”¨é€” + ä»·æ ¼ â‰¤ åŽŸä»·Ã—0.9
ä¹°ç‰›è‚‰é¢„ç®—è¶…æ”¯ â†’ æŽ¨èé¸¡è‚‰
ä»·æ ¼å¯¼å‘
Quality
ç›¸ä¼¼åº¦â‰¥0.6 + åŒè¯­ä¹‰ç»´åº¦
ä¹°æ¾éœ² â†’ æŽ¨èç‰¡è›Žã€é±¼å­é…±
å“è´¨å¯¼å‘
Balanced
è¯­ä¹‰â‰¥0.45 + ä»·æ ¼åœ¨ Â±15% å†…
ä¹°ä¸­æ¡£ç‰›å¥¶ â†’ æŽ¨èåŒç±»å“ç‰Œä¹³åˆ¶å“
å¹³è¡¡å¯¼å‘

Guardrail åªåšè¿‡æ»¤ï¼Œä¸å‚ä¸ŽæŽ’åºã€‚
 è¿™æ ·èƒ½ä¿è¯æŽ¨èæ—¢åˆç†åˆé«˜æ•ˆã€‚

4. LightGBMï¼ˆæ™ºèƒ½å­¦ä¹ å±‚ï¼‰
Guardrail è¿‡æ»¤åŽ â†’ æ‰€æœ‰å€™é€‰è¿›å…¥ LightGBM LambdaMART æŽ’åºã€‚
è¾“å…¥ç‰¹å¾åŒ…æ‹¬ï¼š
åŸºç¡€ç‰¹å¾ï¼šcf_bpr_score, semantic_sim, price_saving, ...


è¡Œä¸ºç‰¹å¾ï¼šbeta_u, budget_pressure, intent_keep_quality_ema, ...


ä¸Šä¸‹æ–‡ç‰¹å¾ï¼šcart_value, mission_type, hour, ...


LightGBM è‡ªåŠ¨å­¦ä¹ è¿™äº›ç‰¹å¾çš„éžçº¿æ€§ç»„åˆä¸Žæƒé‡ï¼š
å½“ intent_keep_quality é«˜æ—¶ â†’ è¯­ä¹‰ç‰¹å¾æƒé‡ä¸Šå‡ï¼›


å½“ budget_pressure é«˜æ—¶ â†’ ä»·æ ¼ç‰¹å¾æƒé‡ä¸Šå‡ï¼›


å½“ beta_u é«˜æ—¶ â†’ å‡å¼±ä»·æ ¼æƒ©ç½šã€‚


ä¹Ÿå°±æ˜¯ï¼š
â€œæ¨¡åž‹è‡ªå·±å­¦ä¼šä»€ä¹ˆæ—¶å€™ä¼˜å…ˆå“è´¨ï¼Œä»€ä¹ˆæ—¶å€™ä¼˜å…ˆä»·æ ¼ã€‚â€

ðŸ§  å››ã€ç³»ç»Ÿè¿è¡Œé€»è¾‘ï¼ˆå®Œæ•´è·¯å¾„ï¼‰
1ï¸âƒ£ ç”¨æˆ·æ‰“å¼€è´­ç‰©è½¦
 â†’ ç³»ç»Ÿæ ¹æ®åŽ†å²ç”Ÿæˆ Î²áµ¤
 â†’ æ ¹æ®å½“å‰ä¼šè¯è®¡ç®— intent_keep_quality_ema
2ï¸âƒ£ åˆ¤æ–­ Guardrail æ¨¡å¼ï¼š
if intent_keep_quality > 0.6 and beta_u > 0.5:
    mode = "quality"
elif intent_keep_quality < 0.4 or beta_u < 0.3:
    mode = "economy"
else:
    mode = "balanced"

3ï¸âƒ£ æ ¹æ®æ¨¡å¼ç­›å‡ºå€™é€‰é›†ã€‚
 4ï¸âƒ£ LightGBM æ ¹æ®å…¨ç‰¹å¾æ‰“åˆ†æŽ’åºã€‚
 5ï¸âƒ£ è¾“å‡ºå‰ N ä¸ªç»“æžœ + è®°å½•æ—¥å¿—ï¼ˆclick/add/purchaseï¼‰ã€‚
 6ï¸âƒ£ æ¯æ—¥/æ¯å‘¨é‡æ–°è®­ç»ƒæ¨¡åž‹ã€‚

ðŸ“Š äº”ã€è¯„ä¼°ä¸Žåé¦ˆ
ç¦»çº¿è¯„ä¼°
æ—¶é—´åˆ‡åˆ†ï¼štâ€“4~tâ€“1 â†’ è®­ç»ƒï¼›t â†’ æµ‹è¯•ï¼›


æŒ‡æ ‡ï¼š


NDCG@10ã€Recall@10ã€Precision@10ï¼›


åˆ†æ®µè¯„ä¼°ï¼špremium_anchor / mission_type / Î²áµ¤ tierï¼›


å†·å¯åŠ¨ï¼ˆU/Iï¼‰è¡¨çŽ°ã€‚


çº¿ä¸Šç›‘æµ‹
CTRã€ATCã€Purchaseã€Basket Sizeã€%BudgetMetã€Overshootï¼›


p95 latency < 200msï¼›


Îµ-greedyï¼ˆ1â€“3%ï¼‰æŽ¢ç´¢æ§½ + è®°å½• propensityï¼Œç”¨äºŽåŽç»­ IPS/SNIPS æ ¡æ­£ã€‚


æˆåŠŸæ ‡å‡†
âœ… è‡³å°‘ä¸¤ä¸ªæ ¸å¿ƒåˆ†ç¾¤æŒ‡æ ‡æå‡ï¼›
 âœ… %BudgetMet ä¸ä¸‹é™ï¼›
 âœ… æŽ¨æ–­å»¶è¿Ÿç¬¦åˆæ ‡å‡†ï¼›
 âœ… æ¨¡åž‹å¯ç°åº¦å›žé€€ã€‚

ðŸ§© å…­ã€ä¸ºä»€ä¹ˆç¬¦åˆä½ çš„ç†å¿µ
ä½ çš„åŽŸå§‹æƒ³æ³•
ç³»ç»Ÿå¯¹åº”å®žçŽ°
æ•ˆæžœ
â€œé¢„ç®—ä¸æ˜¯ä¸€åˆ€åˆ‡ï¼Œè´µçš„ç”¨æˆ·ä»æƒ³ä¿è´¨â€
Î²áµ¤ + intent_keep_quality è”åˆåˆ¤æ–­
åŠ¨æ€åŒºåˆ†çœé’± vs ä¿è´¨æ„å›¾
â€œä¸è¦è®©ä»·æ ¼ä¼˜å…ˆçº§åŽ‹å€’ç›¸ä¼¼åº¦â€
Guardrail + è¯­ä¹‰ç»´åº¦ embedding
åªåœ¨ economy æ¨¡å¼ä¸‹å¼ºåŒ–ä»·æ ¼è¿‡æ»¤
â€œç”¨è¡Œä¸ºé¢„æµ‹è€Œéžè§„åˆ™å†™æ­»â€
LightGBM + behavioral features
æ¨¡åž‹è‡ªå­¦ä¹ ä¸åŒåœºæ™¯æƒé‡
â€œå¸Œæœ›ç³»ç»Ÿè¶Šç”¨è¶Šå‡†â€
æ¯æ¬¡ä¼šè¯æ—¥å¿— + å‘¨æœŸ retrain
æ¨¡åž‹æŒç»­è‡ªé€‚åº”


âœ… æ€»ç»“ä¸€å¥è¯
ä½ çš„ç³»ç»Ÿå·²ç»ä»Žâ€œè§„åˆ™æŽ¨èâ€å‡çº§ä¸ºâ€œè¡Œä¸ºé©±åŠ¨ã€æ„å›¾æ„ŸçŸ¥çš„æ··åˆæŽ¨èç³»ç»Ÿâ€ï¼š
 Guardrail è´Ÿè´£å®‰å…¨ä¸Žçº¦æŸï¼ŒLightGBM è´Ÿè´£å­¦ä¹ ä¸ŽæŽ’åºï¼Œ
 Î²áµ¤ ä¸Ž intent_keep_quality è®©æ¨¡åž‹æ‡‚å¾—ç”¨æˆ·æ­¤åˆ»æ˜¯è¦â€œä¿è´¨â€è¿˜æ˜¯è¦â€œçœé’±â€